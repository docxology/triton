

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>NVWSOps &mdash; Triton  documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css?v=d2d258e8" />
      <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css?v=f4aeca0c" />
      <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css?v=2082cf3c" />
      <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/custom.css" />

  
      <script src="../_static/documentation_options.js?v=5929fcd5"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Introduction" href="../programming-guide/chapter-1/introduction.html" />
    <link rel="prev" title="NVGPUOps" href="NVGPUOps.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Triton
              <img src="https://cdn.openai.com/triton/assets/triton-logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../getting-started/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting-started/tutorials/index.html">Tutorials</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Python API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../python-api/triton.html">triton</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-api/triton.language.html">triton.language</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-api/triton.testing.html">triton.testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-api/triton-semantics.html">Triton Semantics</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Triton MLIR Dialects</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="dialects.html">Triton MLIR Dialects and Ops</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="GluonDialect.html">‘gluon’ Dialect</a></li>
<li class="toctree-l2"><a class="reference internal" href="TritonNvidiaGPUDialect.html">‘ttng’ Dialect</a></li>
<li class="toctree-l2"><a class="reference internal" href="TritonGPUDialect.html">‘ttg’ Dialect</a></li>
<li class="toctree-l2"><a class="reference internal" href="ProtonDialect.html">‘proton’ Dialect</a></li>
<li class="toctree-l2"><a class="reference internal" href="NVGPUDialect.html">‘nvgpu’ Dialect</a></li>
<li class="toctree-l2"><a class="reference internal" href="ProtonGPUDialect.html">‘proton_gpu’ Dialect</a></li>
<li class="toctree-l2"><a class="reference internal" href="NVWSDialect.html">‘nvws’ Dialect</a></li>
<li class="toctree-l2"><a class="reference internal" href="TritonDialect.html">‘tt’ Dialect</a></li>
<li class="toctree-l2"><a class="reference internal" href="TritonInstrumentDialect.html">‘tti’ Dialect</a></li>
<li class="toctree-l2"><a class="reference internal" href="TritonAMDGPUDialect.html">‘amdgpu’ Dialect</a></li>
<li class="toctree-l2"><a class="reference internal" href="TritonInstrumentOps.html">TritonInstrumentOps<!-- Autogenerated by mlir-tblgen; don't manually edit --></a></li>
<li class="toctree-l2"><a class="reference internal" href="TritonAMDGPUOps.html">TritonAMDGPUOps<!-- Autogenerated by mlir-tblgen; don't manually edit --></a></li>
<li class="toctree-l2"><a class="reference internal" href="TritonGPUOps.html">TritonGPUOps<!-- Autogenerated by mlir-tblgen; don't manually edit --></a></li>
<li class="toctree-l2"><a class="reference internal" href="ProtonGPUOps.html">ProtonGPUOps<!-- Autogenerated by mlir-tblgen; don't manually edit --></a></li>
<li class="toctree-l2"><a class="reference internal" href="ProtonOps.html">ProtonOps<!-- Autogenerated by mlir-tblgen; don't manually edit --></a></li>
<li class="toctree-l2"><a class="reference internal" href="GluonOps.html">GluonOps<!-- Autogenerated by mlir-tblgen; don't manually edit --></a></li>
<li class="toctree-l2"><a class="reference internal" href="TritonOps.html">TritonOps<!-- Autogenerated by mlir-tblgen; don't manually edit --></a></li>
<li class="toctree-l2"><a class="reference internal" href="TritonNvidiaGPUOps.html">TritonNvidiaGPUOps<!-- Autogenerated by mlir-tblgen; don't manually edit --></a></li>
<li class="toctree-l2"><a class="reference internal" href="NVGPUOps.html">NVGPUOps<!-- Autogenerated by mlir-tblgen; don't manually edit --></a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">NVWSOps<!-- Autogenerated by mlir-tblgen; don't manually edit --></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#nvws-aref-create-triton-nvws-arefcreateop"><code class="docutils literal notranslate"><span class="pre">nvws.aref.create</span></code> (triton::nvws::ArefCreateOp)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#operands">Operands:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#results">Results:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nvws-aref-get-enter-triton-nvws-arefgetenterop"><code class="docutils literal notranslate"><span class="pre">nvws.aref.get.enter</span></code> (triton::nvws::ArefGetEnterOp)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id1">Operands:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id2">Results:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nvws-aref-get-exit-triton-nvws-arefgetexitop"><code class="docutils literal notranslate"><span class="pre">nvws.aref.get.exit</span></code> (triton::nvws::ArefGetExitOp)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#attributes">Attributes:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id3">Operands:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nvws-aref-put-enter-triton-nvws-arefputenterop"><code class="docutils literal notranslate"><span class="pre">nvws.aref.put.enter</span></code> (triton::nvws::ArefPutEnterOp)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id4">Operands:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id5">Results:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nvws-aref-put-exit-triton-nvws-arefputexitop"><code class="docutils literal notranslate"><span class="pre">nvws.aref.put.exit</span></code> (triton::nvws::ArefPutExitOp)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id6">Attributes:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id7">Operands:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nvws-consumer-release-triton-nvws-consumerreleaseop"><code class="docutils literal notranslate"><span class="pre">nvws.consumer_release</span></code> (triton::nvws::ConsumerReleaseOp)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id8">Operands:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nvws-consumer-wait-triton-nvws-consumerwaitop"><code class="docutils literal notranslate"><span class="pre">nvws.consumer_wait</span></code> (triton::nvws::ConsumerWaitOp)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id9">Operands:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nvws-create-token-triton-nvws-createtokenop"><code class="docutils literal notranslate"><span class="pre">nvws.create_token</span></code> (triton::nvws::CreateTokenOp)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id10">Attributes:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id11">Results:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nvws-descriptor-gather-triton-nvws-descriptorgatherop"><code class="docutils literal notranslate"><span class="pre">nvws.descriptor_gather</span></code> (triton::nvws::DescriptorGatherOp)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id12">Attributes:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id13">Operands:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nvws-descriptor-load-triton-nvws-descriptorloadop"><code class="docutils literal notranslate"><span class="pre">nvws.descriptor_load</span></code> (triton::nvws::DescriptorLoadOp)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id14">Attributes:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id15">Operands:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nvws-producer-acquire-triton-nvws-produceracquireop"><code class="docutils literal notranslate"><span class="pre">nvws.producer_acquire</span></code> (triton::nvws::ProducerAcquireOp)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id16">Operands:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nvws-producer-commit-triton-nvws-producercommitop"><code class="docutils literal notranslate"><span class="pre">nvws.producer_commit</span></code> (triton::nvws::ProducerCommitOp)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id17">Operands:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nvws-warp-group-triton-nvws-warpgroupop"><code class="docutils literal notranslate"><span class="pre">nvws.warp_group</span></code> (triton::nvws::WarpGroupOp)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id18">Attributes:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id19">Results:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nvws-warp-group-return-triton-nvws-warpgroupreturnop"><code class="docutils literal notranslate"><span class="pre">nvws.warp_group.return</span></code> (triton::nvws::WarpGroupReturnOp)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#nvws-warp-group-yield-triton-nvws-warpgroupyieldop"><code class="docutils literal notranslate"><span class="pre">nvws.warp_group.yield</span></code> (triton::nvws::WarpGroupYieldOp)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id20">Operands:</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Programming Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../programming-guide/chapter-1/introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../programming-guide/chapter-2/related-work.html">Related Work</a></li>
<li class="toctree-l1"><a class="reference internal" href="../programming-guide/chapter-3/debugging.html">Debugging Triton</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Triton</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="dialects.html">Triton MLIR Dialects and Ops</a></li>
      <li class="breadcrumb-item active">NVWSOps<!-- Autogenerated by mlir-tblgen; don't manually edit --></li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/dialects/NVWSOps.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="nvwsops">
<h1>NVWSOps<!-- Autogenerated by mlir-tblgen; don't manually edit --><a class="headerlink" href="#nvwsops" title="Link to this heading">¶</a></h1>
<section id="nvws-aref-create-triton-nvws-arefcreateop">
<h2><code class="docutils literal notranslate"><span class="pre">nvws.aref.create</span></code> (triton::nvws::ArefCreateOp)<a class="headerlink" href="#nvws-aref-create-triton-nvws-arefcreateop" title="Link to this heading">¶</a></h2>
<p><em>Create an asynchronous reference.</em></p>
<p>Syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>operation ::= `nvws.aref.create` $buffers attr-dict `:` type($result)
</pre></div>
</div>
<p>Create an asynchronous reference.</p>
<p>Takes as inputs a variadic number of buffers, and returns an ARef.
The inputs are expected to be array-like (i.e., Tensor, MemDesc, etc)
and the first axis of the shape should match between all inputs, representing
multi-buffering of the values.</p>
<p>Traits: <code class="docutils literal notranslate"><span class="pre">AlwaysSpeculatableImplTrait</span></code></p>
<p>Interfaces: <code class="docutils literal notranslate"><span class="pre">ConditionallySpeculatable</span></code>, <code class="docutils literal notranslate"><span class="pre">NoMemoryEffect</span> <span class="pre">(MemoryEffectOpInterface)</span></code></p>
<p>Effects: <code class="docutils literal notranslate"><span class="pre">MemoryEffects::Effect{}</span></code></p>
<section id="operands">
<h3>Operands:<a class="headerlink" href="#operands" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Operand</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">buffers</span></code></p></td>
<td><p>variadic of memory descriptor type (<code class="docutils literal notranslate"><span class="pre">::mlir::triton::gpu::MemDescType</span></code>) in Triton IR type system</p></td>
</tr>
</tbody>
</table>
</section>
<section id="results">
<h3>Results:<a class="headerlink" href="#results" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Result</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">result</span></code></p></td>
<td><p>Asynchronous Reference</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="nvws-aref-get-enter-triton-nvws-arefgetenterop">
<h2><code class="docutils literal notranslate"><span class="pre">nvws.aref.get.enter</span></code> (triton::nvws::ArefGetEnterOp)<a class="headerlink" href="#nvws-aref-get-enter-triton-nvws-arefgetenterop" title="Link to this heading">¶</a></h2>
<p><em>Enter ArefGet region where the buffer can be used to read data</em></p>
<p>Syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>operation ::= `nvws.aref.get.enter` $aref ( `[` $stage^ `,` $phase `]`)? attr-dict
              `:` type($aref) `-&gt;` type(results)
</pre></div>
</div>
<p>Enter a “region” where you can freely read from the buffer)
These ArefGet “regions” can span multiple iterations.</p>
<p>Traits: <code class="docutils literal notranslate"><span class="pre">AttrSizedOperandSegments</span></code></p>
<p>Interfaces: <code class="docutils literal notranslate"><span class="pre">ArefStageInterface</span></code></p>
<section id="id1">
<h3>Operands:<a class="headerlink" href="#id1" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Operand</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">aref</span></code></p></td>
<td><p>Asynchronous Reference</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">stage</span></code></p></td>
<td><p>32-bit signless integer</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">phase</span></code></p></td>
<td><p>32-bit signless integer</p></td>
</tr>
</tbody>
</table>
</section>
<section id="id2">
<h3>Results:<a class="headerlink" href="#id2" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Result</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">buffers</span></code></p></td>
<td><p>variadic of memory descriptor type (<code class="docutils literal notranslate"><span class="pre">::mlir::triton::gpu::MemDescType</span></code>) in Triton IR type system</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">token</span></code></p></td>
<td><p>async token type</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="nvws-aref-get-exit-triton-nvws-arefgetexitop">
<h2><code class="docutils literal notranslate"><span class="pre">nvws.aref.get.exit</span></code> (triton::nvws::ArefGetExitOp)<a class="headerlink" href="#nvws-aref-get-exit-triton-nvws-arefgetexitop" title="Link to this heading">¶</a></h2>
<p><em>Exit ArefGet region, where the buffer should no longer be used</em></p>
<p>Syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>operation ::= `nvws.aref.get.exit` $aref (`[` $stage^ `]`)? `,` $token $async_ops attr-dict
              `:` type($aref) `,` type($token)
</pre></div>
</div>
<p>Leave the region where you can freely read from the buffer).
These ArefGet “regions” can span multiple iterations.</p>
<p>Interfaces: <code class="docutils literal notranslate"><span class="pre">ArefStageInterface</span></code></p>
<section id="attributes">
<h3>Attributes:<a class="headerlink" href="#attributes" title="Link to this heading">¶</a></h3>
<table>
<tr><th>Attribute</th><th>MLIR Type</th><th>Description</th></tr>
<tr><td><code>async_ops</code></td><td>::mlir::ArrayAttr</td><td>array of async op attributes</td></tr>
</table>
</section>
<section id="id3">
<h3>Operands:<a class="headerlink" href="#id3" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Operand</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">aref</span></code></p></td>
<td><p>Asynchronous Reference</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">token</span></code></p></td>
<td><p>async token type</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">stage</span></code></p></td>
<td><p>32-bit signless integer</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="nvws-aref-put-enter-triton-nvws-arefputenterop">
<h2><code class="docutils literal notranslate"><span class="pre">nvws.aref.put.enter</span></code> (triton::nvws::ArefPutEnterOp)<a class="headerlink" href="#nvws-aref-put-enter-triton-nvws-arefputenterop" title="Link to this heading">¶</a></h2>
<p><em>Enter ArefPut region where the buffer can be used to read data</em></p>
<p>Syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>operation ::= `nvws.aref.put.enter` $aref ( `[` $stage^ `,` $phase `]`)? attr-dict
              `:` type($aref) `-&gt;` type(results)
</pre></div>
</div>
<p>Enter a “region” where you can freely write to the buffer)
These ArefPut “regions” can span multiple iterations.</p>
<p>Traits: <code class="docutils literal notranslate"><span class="pre">AttrSizedOperandSegments</span></code></p>
<p>Interfaces: <code class="docutils literal notranslate"><span class="pre">ArefStageInterface</span></code></p>
<section id="id4">
<h3>Operands:<a class="headerlink" href="#id4" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Operand</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">aref</span></code></p></td>
<td><p>Asynchronous Reference</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">stage</span></code></p></td>
<td><p>32-bit signless integer</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">phase</span></code></p></td>
<td><p>32-bit signless integer</p></td>
</tr>
</tbody>
</table>
</section>
<section id="id5">
<h3>Results:<a class="headerlink" href="#id5" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Result</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">buffers</span></code></p></td>
<td><p>variadic of memory descriptor type (<code class="docutils literal notranslate"><span class="pre">::mlir::triton::gpu::MemDescType</span></code>) in Triton IR type system</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">token</span></code></p></td>
<td><p>async token type</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="nvws-aref-put-exit-triton-nvws-arefputexitop">
<h2><code class="docutils literal notranslate"><span class="pre">nvws.aref.put.exit</span></code> (triton::nvws::ArefPutExitOp)<a class="headerlink" href="#nvws-aref-put-exit-triton-nvws-arefputexitop" title="Link to this heading">¶</a></h2>
<p><em>Exit ArefPut region, where the buffer should no longer be used</em></p>
<p>Syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>operation ::= `nvws.aref.put.exit` $aref (`[` $stage^ `]`)? `,` $token  $async_ops attr-dict
              `:` type($aref) `,` type($token)
</pre></div>
</div>
<p>Leave the region where you can freely write to the buffer).
These ArefPut “regions” can span multiple iterations.</p>
<p>Interfaces: <code class="docutils literal notranslate"><span class="pre">ArefStageInterface</span></code></p>
<section id="id6">
<h3>Attributes:<a class="headerlink" href="#id6" title="Link to this heading">¶</a></h3>
<table>
<tr><th>Attribute</th><th>MLIR Type</th><th>Description</th></tr>
<tr><td><code>async_ops</code></td><td>::mlir::ArrayAttr</td><td>array of async op attributes</td></tr>
</table>
</section>
<section id="id7">
<h3>Operands:<a class="headerlink" href="#id7" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Operand</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">aref</span></code></p></td>
<td><p>Asynchronous Reference</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">token</span></code></p></td>
<td><p>async token type</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">stage</span></code></p></td>
<td><p>32-bit signless integer</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="nvws-consumer-release-triton-nvws-consumerreleaseop">
<h2><code class="docutils literal notranslate"><span class="pre">nvws.consumer_release</span></code> (triton::nvws::ConsumerReleaseOp)<a class="headerlink" href="#nvws-consumer-release-triton-nvws-consumerreleaseop" title="Link to this heading">¶</a></h2>
<p><em>Consumer releases the token</em></p>
<p>Syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>operation ::= `nvws.consumer_release` $token `,` $idx attr-dict `:` type(operands)
</pre></div>
</div>
<p>The consumer will release the token and signal the producer
that the buffers are ready to be filled.</p>
<section id="id8">
<h3>Operands:<a class="headerlink" href="#id8" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Operand</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">token</span></code></p></td>
<td><p>tensor of  values</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">idx</span></code></p></td>
<td><p>32-bit signless integer</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="nvws-consumer-wait-triton-nvws-consumerwaitop">
<h2><code class="docutils literal notranslate"><span class="pre">nvws.consumer_wait</span></code> (triton::nvws::ConsumerWaitOp)<a class="headerlink" href="#nvws-consumer-wait-triton-nvws-consumerwaitop" title="Link to this heading">¶</a></h2>
<p><em>Consumer awaits buffer readiness</em></p>
<p>Syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>operation ::= `nvws.consumer_wait` $token `,` $idx `,` $phase attr-dict `:` type(operands)
</pre></div>
</div>
<p>The consumer will wait for the buffer to be ready
to be consumed. If the buffers are not ready, the consumer will wait to be
signalled by the producer which finishes filling the buffers and
releases the token.</p>
<section id="id9">
<h3>Operands:<a class="headerlink" href="#id9" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Operand</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">token</span></code></p></td>
<td><p>tensor of  values</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">idx</span></code></p></td>
<td><p>32-bit signless integer</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">phase</span></code></p></td>
<td><p>1-bit signless integer</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="nvws-create-token-triton-nvws-createtokenop">
<h2><code class="docutils literal notranslate"><span class="pre">nvws.create_token</span></code> (triton::nvws::CreateTokenOp)<a class="headerlink" href="#nvws-create-token-triton-nvws-createtokenop" title="Link to this heading">¶</a></h2>
<p><em>Create a token to be used for synchronizations in communication channels</em></p>
<p>Syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>operation ::= `nvws.create_token` attr-dict `:` type($result)
</pre></div>
</div>
<p>A token will be used by the producer and consumer to synchronize.
The producer will acquire and hold the token, until it has filled the buffers,
and signal the waiting consumer.
The consumer will hold the token until it has consumed the buffers,
and will signal the waiting producer trying to acquire the token.</p>
<section id="id10">
<h3>Attributes:<a class="headerlink" href="#id10" title="Link to this heading">¶</a></h3>
<table>
<tr><th>Attribute</th><th>MLIR Type</th><th>Description</th></tr>
<tr><td><code>numBuffers</code></td><td>::mlir::IntegerAttr</td><td>32-bit signless integer attribute</td></tr>
<tr><td><code>loadType</code></td><td>::mlir::triton::nvws::TokenLoadTypeAttr</td><td>allowed 32-bit signless integer cases: 0, 1, 2, 3, 4</td></tr>
</table>
</section>
<section id="id11">
<h3>Results:<a class="headerlink" href="#id11" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Result</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">result</span></code></p></td>
<td><p>tensor of  values</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="nvws-descriptor-gather-triton-nvws-descriptorgatherop">
<h2><code class="docutils literal notranslate"><span class="pre">nvws.descriptor_gather</span></code> (triton::nvws::DescriptorGatherOp)<a class="headerlink" href="#nvws-descriptor-gather-triton-nvws-descriptorgatherop" title="Link to this heading">¶</a></h2>
<p><em>Gather multiple rows from a descriptor into shared memory</em></p>
<p>Syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>operation ::= `nvws.descriptor_gather` $desc `[` $x_offsets `,` $y_offset `]` $txCount $result
              attr-dict `:` type(operands)
</pre></div>
</div>
<p>This op behaves exactly like the op with the same name in Triton Dialect, but the result of the load is stored into shared memory.
The execution is still synchronous.</p>
<p>Interfaces: <code class="docutils literal notranslate"><span class="pre">NVWS_DescriptorLoadOpInterface</span></code>, <code class="docutils literal notranslate"><span class="pre">TT_DescriptorOpInterface</span></code></p>
<section id="id12">
<h3>Attributes:<a class="headerlink" href="#id12" title="Link to this heading">¶</a></h3>
<table>
<tr><th>Attribute</th><th>MLIR Type</th><th>Description</th></tr>
<tr><td><code>txCount</code></td><td>::mlir::IntegerAttr</td><td>32-bit signless integer attribute</td></tr>
</table>
</section>
<section id="id13">
<h3>Operands:<a class="headerlink" href="#id13" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Operand</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">desc</span></code></p></td>
<td><p>Tensor descriptor type (<code class="docutils literal notranslate"><span class="pre">::mlir::triton::TensorDescType</span></code>) in Triton IR type system</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">x_offsets</span></code></p></td>
<td><p>ranked tensor of 32-bit signless integer values</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">y_offset</span></code></p></td>
<td><p>32-bit signless integer</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">result</span></code></p></td>
<td><p>memory descriptor type (<code class="docutils literal notranslate"><span class="pre">::mlir::triton::gpu::MemDescType</span></code>) in Triton IR type system</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="nvws-descriptor-load-triton-nvws-descriptorloadop">
<h2><code class="docutils literal notranslate"><span class="pre">nvws.descriptor_load</span></code> (triton::nvws::DescriptorLoadOp)<a class="headerlink" href="#nvws-descriptor-load-triton-nvws-descriptorloadop" title="Link to this heading">¶</a></h2>
<p><em>Load from descriptor and store into shared memory</em></p>
<p>Syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>operation ::= `nvws.descriptor_load` $desc `[` $indices `]` $txCount $result
              oilist(
              `cacheModifier` `=` $cache |
              `evictionPolicy` `=` $evict
              )
              attr-dict `:` type(operands)
</pre></div>
</div>
<p>This op behaves exactly like the op with the same name in Triton Dialect, but the result of the load is stored into shared memory.
The execution is still synchronous.</p>
<p>Interfaces: <code class="docutils literal notranslate"><span class="pre">NVWS_DescriptorLoadOpInterface</span></code>, <code class="docutils literal notranslate"><span class="pre">TT_DescriptorOpInterface</span></code></p>
<section id="id14">
<h3>Attributes:<a class="headerlink" href="#id14" title="Link to this heading">¶</a></h3>
<table>
<tr><th>Attribute</th><th>MLIR Type</th><th>Description</th></tr>
<tr><td><code>txCount</code></td><td>::mlir::IntegerAttr</td><td>32-bit signless integer attribute</td></tr>
<tr><td><code>cache</code></td><td>::mlir::triton::CacheModifierAttr</td><td>allowed 32-bit signless integer cases: 1, 2, 3, 4, 5, 6, 7</td></tr>
<tr><td><code>evict</code></td><td>::mlir::triton::EvictionPolicyAttr</td><td>allowed 32-bit signless integer cases: 1, 2, 3</td></tr>
</table>
</section>
<section id="id15">
<h3>Operands:<a class="headerlink" href="#id15" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Operand</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">desc</span></code></p></td>
<td><p>Tensor descriptor type (<code class="docutils literal notranslate"><span class="pre">::mlir::triton::TensorDescType</span></code>) in Triton IR type system</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">indices</span></code></p></td>
<td><p>variadic of 32-bit signless integer</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">result</span></code></p></td>
<td><p>memory descriptor type (<code class="docutils literal notranslate"><span class="pre">::mlir::triton::gpu::MemDescType</span></code>) in Triton IR type system</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="nvws-producer-acquire-triton-nvws-produceracquireop">
<h2><code class="docutils literal notranslate"><span class="pre">nvws.producer_acquire</span></code> (triton::nvws::ProducerAcquireOp)<a class="headerlink" href="#nvws-producer-acquire-triton-nvws-produceracquireop" title="Link to this heading">¶</a></h2>
<p><em>Producer acquires a token to fill buffers</em></p>
<p>Syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>operation ::= `nvws.producer_acquire` $token `,` $idx `,` $phase attr-dict `:` type(operands)
</pre></div>
</div>
<p>The producer will try to acquire the token prior to filling
the buffers. If the buffers are not ready to be filled, the producer will wait to be
signalled by the consumer which finishes consuming the buffers and
releases the token.</p>
<section id="id16">
<h3>Operands:<a class="headerlink" href="#id16" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Operand</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">token</span></code></p></td>
<td><p>tensor of  values</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">idx</span></code></p></td>
<td><p>32-bit signless integer</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">phase</span></code></p></td>
<td><p>1-bit signless integer</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="nvws-producer-commit-triton-nvws-producercommitop">
<h2><code class="docutils literal notranslate"><span class="pre">nvws.producer_commit</span></code> (triton::nvws::ProducerCommitOp)<a class="headerlink" href="#nvws-producer-commit-triton-nvws-producercommitop" title="Link to this heading">¶</a></h2>
<p><em>Producer commits the buffer changes</em></p>
<p>Syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>operation ::= `nvws.producer_commit` $token `,` $idx attr-dict `:` type(operands)
</pre></div>
</div>
<p>The producer will release the token and signal the consumer
that the buffers are ready to be consumed.</p>
<section id="id17">
<h3>Operands:<a class="headerlink" href="#id17" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Operand</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">token</span></code></p></td>
<td><p>tensor of  values</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">idx</span></code></p></td>
<td><p>32-bit signless integer</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="nvws-warp-group-triton-nvws-warpgroupop">
<h2><code class="docutils literal notranslate"><span class="pre">nvws.warp_group</span></code> (triton::nvws::WarpGroupOp)<a class="headerlink" href="#nvws-warp-group-triton-nvws-warpgroupop" title="Link to this heading">¶</a></h2>
<p><em>Container Op for Warp Specialization</em></p>
<p>Higher level container for Warp Specialization Analysis.</p>
<p>Contains a variadic number warp groups, with
the number of warps in each group, plus a region to hold the
computation for that warp group.</p>
<p>The results of this op, if any, are those of the first region, as returned by
nvws.warp_group.yield op.</p>
<p>nvws.warp_group should be lowered to ttg.warp_specialize
before execution.</p>
<p>Traits: <code class="docutils literal notranslate"><span class="pre">RecursiveMemoryEffects</span></code>, <code class="docutils literal notranslate"><span class="pre">RecursivelySpeculatableImplTrait</span></code></p>
<p>Interfaces: <code class="docutils literal notranslate"><span class="pre">ConditionallySpeculatable</span></code></p>
<section id="id18">
<h3>Attributes:<a class="headerlink" href="#id18" title="Link to this heading">¶</a></h3>
<table>
<tr><th>Attribute</th><th>MLIR Type</th><th>Description</th></tr>
<tr><td><code>numWarps</code></td><td>::mlir::DenseI32ArrayAttr</td><td>i32 dense array attribute</td></tr>
</table>
</section>
<section id="id19">
<h3>Results:<a class="headerlink" href="#id19" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Result</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">results</span></code></p></td>
<td><p>variadic of any type</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="nvws-warp-group-return-triton-nvws-warpgroupreturnop">
<h2><code class="docutils literal notranslate"><span class="pre">nvws.warp_group.return</span></code> (triton::nvws::WarpGroupReturnOp)<a class="headerlink" href="#nvws-warp-group-return-triton-nvws-warpgroupreturnop" title="Link to this heading">¶</a></h2>
<p><em>Terminator for a warp group region</em></p>
<p>Syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>operation ::= `nvws.warp_group.return` attr-dict
</pre></div>
</div>
<p>Warp groups are expected to return values via referential modification
of their inputs. Thus, the warp_group.return op takes no values to
return from the warp group.</p>
<p>Traits: <code class="docutils literal notranslate"><span class="pre">AlwaysSpeculatableImplTrait</span></code>, <code class="docutils literal notranslate"><span class="pre">HasParent&lt;WarpGroupOp&gt;</span></code>, <code class="docutils literal notranslate"><span class="pre">Terminator</span></code></p>
<p>Interfaces: <code class="docutils literal notranslate"><span class="pre">ConditionallySpeculatable</span></code>, <code class="docutils literal notranslate"><span class="pre">NoMemoryEffect</span> <span class="pre">(MemoryEffectOpInterface)</span></code></p>
<p>Effects: <code class="docutils literal notranslate"><span class="pre">MemoryEffects::Effect{}</span></code></p>
</section>
<section id="nvws-warp-group-yield-triton-nvws-warpgroupyieldop">
<h2><code class="docutils literal notranslate"><span class="pre">nvws.warp_group.yield</span></code> (triton::nvws::WarpGroupYieldOp)<a class="headerlink" href="#nvws-warp-group-yield-triton-nvws-warpgroupyieldop" title="Link to this heading">¶</a></h2>
<p><em>Yield from the first region of <code class="docutils literal notranslate"><span class="pre">nvws.warp_group</span></code></em></p>
<p>Syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>operation ::= `nvws.warp_group.yield` ($values^)? attr-dict (`:` type($values)^)?
</pre></div>
</div>
<p>This op is equivalent to ttg.warp_yield op for ttg.warp_specialize op.</p>
<p>TODO: Decide if we should move nvws.warp_group to TritonGPU, or continue to
have TritonGPU depend on NVWS. In the former case, this op can be removed.
The latter one involves a circular dependency between TritonGPU and NVWS.</p>
<p>Traits: <code class="docutils literal notranslate"><span class="pre">AlwaysSpeculatableImplTrait</span></code>, <code class="docutils literal notranslate"><span class="pre">HasParent&lt;WarpGroupOp&gt;</span></code>, <code class="docutils literal notranslate"><span class="pre">ReturnLike</span></code>, <code class="docutils literal notranslate"><span class="pre">Terminator</span></code></p>
<p>Interfaces: <code class="docutils literal notranslate"><span class="pre">ConditionallySpeculatable</span></code>, <code class="docutils literal notranslate"><span class="pre">NoMemoryEffect</span> <span class="pre">(MemoryEffectOpInterface)</span></code>, <code class="docutils literal notranslate"><span class="pre">RegionBranchTerminatorOpInterface</span></code></p>
<p>Effects: <code class="docutils literal notranslate"><span class="pre">MemoryEffects::Effect{}</span></code></p>
<section id="id20">
<h3>Operands:<a class="headerlink" href="#id20" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Operand</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">values</span></code></p></td>
<td><p>variadic of any type</p></td>
</tr>
</tbody>
</table>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="NVGPUOps.html" class="btn btn-neutral float-left" title="NVGPUOps" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../programming-guide/chapter-1/introduction.html" class="btn btn-neutral float-right" title="Introduction" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020, Philippe Tillet.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>